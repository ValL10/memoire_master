{% extends 'core/base.html' %}

{% block title %}
    Afficher Réponse
{% endblock %}

{% block head %}
    {% load static %}
    <link rel="stylesheet" href={% static "core/assets/codemirror/codemirror.min.css" %}>
    <link rel="stylesheet" href={% static "core/assets/codemirror/monokai.min.css" %}>
    <link rel="stylesheet" href={% static "core/assets/codemirror/dracula.min.css" %}>
    <link rel="stylesheet" href={% static "core/assets/codemirror/material.min.css" %}>
    
    <script src={% static "core/assets/codemirror/codemirror.min.js" %}></script>
    <script src= {% static "core/assets/codemirror/python.min.js" %}></script>
{% endblock %}

{% block navbar %}
    {% include 'core/navbar.html' %}
{% endblock %}

{% block content %}
<section class="m-2 p-1">

    <div class="container p-1">
        <div class="card jumbotron m-1 p-1 shadow-sm">
            <div class="accordion accordion-flush" id="accordionFlushExample">
                <div class="accordion-item">
                  <h2 class="accordion-header">
                    <div class="accordion-button collapsed p-2" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseOne" aria-expanded="false" aria-controls="flush-collapseOne">
                        <div>
                            <h5 class="p-2">
                                {{ reponse.exercice.titre_exercice }}
                            </h5>
                        </div>
                    </div>
                  </h2>
                  <div id="flush-collapseOne" class="accordion-collapse collapse show" data-bs-parent="#accordionFlushExample">
                    <div class="accordion-body">
                        <div>
                            <h6 class="p-2">
                                <span class="badge bg-light text-dark"><i class="fa fa-user-tag"></i> {{ reponse.exercice.created_at }}</span>
                                <span class="badge bg-dark"><i class="fa fa-user-tag"></i> {{ reponse.exercice.parcours_cible }} </span>
                                <span class="badge bg-dark"><i class="fa fa-tag"></i> {{ reponse.exercice.niveau_cible }} </span>
                                <span class="badge bg-success"><i class="fab fa-python"></i> {{ reponse.exercice.langage_exercice }} </span>
                                <span class="badge 
                                {% if reponse.exercice.complexite_exercice == 1 %}
                                    bg-info text-dark
                                {% elif reponse.exercice.complexite_exercice == 2 %}
                                    bg-primary text-white
                                {% elif reponse.exercice.complexite_exercice == 3 %}
                                    bg-success text-white
                                {% elif reponse.exercice.complexite_exercice == 4 %}
                                    bg-warning text-dark
                                {% else %}
                                    bg-danger text-white
                                {%endif%}
                                ">
                                    <i class="fas fa-layer-group"></i> Compléxité: {{ reponse.exercice.complexite_exercice }}
                                </span>
                            </h6>
                        </div>
                        <div class="m-2">
                            <p class="lead"> {{ reponse.exercice.description_exercice }} </p>
                        </div>
                    </div>
                  </div>
                </div>
            </div>
        </div>
    </div>

    <section class="container">
        <div class="mt-1">
            <div class="row">
                <div class="col-lg-8 col-md-8">
                    <div class="card p-1 shadow-sm">
                        <div class="m-1">
                            <h6 class="m-1"><i class="fas fa-code"></i>Code soumis</h6>
                        </div>
                        <textarea id="code-editor" name="codeValue" class="form-control codemirror m-1" rows="40">{{ reponse.contenu_reponse }}</textarea>
                    </div>
                </div>
                <div class="col-lg-4 col-md-4">
                    <div class="card p-1 shadow-sm">
                        <div class="accordion" id="accordionExample">
                            <div class="accordion-item">
                              <h4 class="accordion-header">
                                <div class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                                    <h6 class="m-1 text-primary"><i class="fas fa-comment-dots"></i> Retours:</h6>
                                </div>
                              </h4>
                              <div id="collapseOne" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
                                <div class="accordion-body">
                                  
                                </div>
                              </div>
                            </div>
                            <div class="accordion-item">
                              <h4 class="accordion-header">
                                <div class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="true" aria-controls="collapseTwo">
                                    <h6 class="m-1 text-success"><i class="fas fa-poll-h"></i> Note:</h6>
                                </div>
                              </h4>
                              <div id="collapseTwo" class="accordion-collapse collapse show" data-bs-parent="#accordionExample">
                                <div class="accordion-body
                                {% if reponse.note.note_numerique > 10 %}
                                    bg-success text-white
                                {% else %}
                                    bg-danger text-white
                                {% endif %}
                                align-items-center justify-content-between text-center">
                                  <h2 class="display-5"><span id="score"></span> / 20 </h2>
                                </div>
                              </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

</section>

{% load static %}
<script src="{% static "core/assets/js/jquery.min.js" %}"></script> 

<script>
    document.addEventListener("DOMContentLoaded", function () {
        var editor = CodeMirror.fromTextArea(document.getElementById("code-editor"), {
            mode: "python",
            theme: "dracula", // Vous pouvez choisir un thème parmi ceux disponibles
            lineNumbers: true, // Pour afficher les numéros de ligne (facultatif)
            indentUnit: 4,
            readOnly: true,
        });
    });
</script>

<script>
    $(document).ready(function() {
        var duration = 1000; 
    
        function animateCounter(div, endValue) {
            $(div).prop('Counter', 0).animate({
                Counter: parseInt(endValue)
            }, {
                duration: duration,
                easing: 'swing',
                step: function(now) {
                    $(div).text(Math.ceil(now));
                }
            });
        }
    
        animateCounter('#score', '{{ reponse.note.note_numerique }}');
    });
</script>

{% endblock %}
